% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/watl_algorithm.R
\name{compute_f1_hat}
\alias{compute_f1_hat}
\title{Compute Weighted Auxiliary Estimator (Step 1 of WaTL)}
\usage{
compute_f1_hat(source_data_list, X_value, M, X_t = NULL, Y_t = NULL)
}
\arguments{
\item{source_data_list}{List of K source datasets, each containing X_s and Y_s.}

\item{X_value}{Query point where to evaluate the estimator.}

\item{M}{Grid size for quantile functions.}

\item{X_t}{Target predictors (optional, but recommended).}

\item{Y_t}{Target quantile functions (optional, but recommended).}
}
\value{
The weighted auxiliary estimator evaluated at X_value (vector of length M).
}
\description{
Implements the weighted auxiliary estimator that aggregates information
from both target (k=0) and source (k=1,...,K) datasets using global Frechet weights.
}
\details{
The weighted auxiliary estimator is computed as:
\deqn{\hat{f}(x) = \frac{1}{n_0 + n_A} \sum_{k=0}^K n_k \hat{f}^{(k)}(x)}

where:
\itemize{
  \item \eqn{\hat{f}^{(k)}(x) = \frac{1}{n_k} \sum_{i=1}^{n_k} s_G^{(k)}(x_i) F^{-1}_{\nu_i^{(k)}}}
  \item \eqn{s_G^{(k)}(x) = 1 + (X^{(k)} - \theta_k)^T \Sigma_k^{-1} (x - \theta_k)} (global Frechet weight)
  \item \eqn{n_A = \sum_{k=1}^K n_k} (total source sample size)
}
}
\examples{
\dontrun{
data <- simulate_data_setting1(n_t = 200, n_vec = c(100, 200, 300), M = 100, K = 3)
f1_hat <- compute_f1_hat(data$source_data, X_value = 0.5, M = 100,
                         X_t = data$X_t, Y_t = data$Y_t)
}
}
